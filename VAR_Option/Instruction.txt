1. Introduction
This program is designed to calculate the Value of Risk and Expected Shortfall of vanilla option using three traditional methods:
a. Historical Method: Use historical option price change to simulated future option price, then caculate future P&L, then we have VaR and ES
b. Analytical Method (include two methods):
	1) Assume return of option follow normal distribution, VaR = mu - alpha*sigma;
	2) Use historical Greeks letter and stock price change and volatility change to caculate future P&L, then caculate VaR and ES.
	   We use dP = delta*dS+0.5*gamma*dS^2+vega*dsigma
c. Monte Carlo Methods: Use Geometric Brownian Motion (GBM) to simulate stock price, then perform caculation similar with b(2), note we only simulate stock, not volatility

Note: The program is very similar with project of VAR_CurrencyForward, the only difference is in VaR.cpp and data sets. See comments in VAR_CurrencyForward for more information.


2. Data Input
See Main.cpp for data input, try StrikeApple145_2015.csv. You can use new data sets from StrikeApple145.csv
Note: the data must includes: STOCK_PRICE	STOCK_RETURN	OPTION_PRICE	OPTION_RETURN	IMPLIED_VOLATILITY	DELTA	GAMMA	VEGA

3. Result
After running the result, we can see the result. See results from StrikeApple145_2015.csv as follow. We can see the VaR and Expected Shortfall calculate by methods a, b(2), c are very close. 
But the result in b(1) is not good, because return of option usually not follow normal distribution.

OUTPUT:

Calculate VaR by historical method:
Option      Portfolio            P&L
43.98        4397.50         245.00
41.63        4162.50          10.00
40.95        4095.00         -57.50
38.60        3860.00        -292.50
41.27        4127.50         -25.00
43.67        4367.50         215.00
40.75        4075.00         -77.50
42.40        4240.00          87.50
43.52        4352.50         200.00
42.02        4202.50          50.00
39.50        3950.00        -202.50
40.08        4007.50        -145.00
39.42        3942.50        -210.00
40.30        4030.00        -122.50
41.38        4137.50         -15.00
43.50        4350.00         197.50
38.27        3827.50        -325.00
39.70        3970.00        -182.50
43.23        4322.50         170.00
40.27        4027.50        -125.00
41.22        4122.50         -30.00
40.20        4020.00        -132.50
41.32        4132.50         -20.00
42.10        4210.00          57.50
40.80        4080.00         -72.50
40.10        4010.00        -142.50
39.95        3995.00        -157.50
40.90        4090.00         -62.50
41.15        4115.00         -37.50
40.88        4087.50         -65.00
41.32        4132.50         -20.00
41.42        4142.50         -10.00
41.20        4120.00         -32.50
39.57        3957.50        -195.00
42.05        4205.00          52.50
43.35        4335.00         182.50
40.85        4085.00         -67.50
10.82        1082.50       -3070.00
72.88        7287.50        3135.00
41.55        4155.00           2.50
41.55        4155.00           2.50
43.13        4312.50         160.00
41.10        4110.00         -42.50
41.07        4107.50         -45.00
43.13        4312.50         160.00
42.70        4270.00         117.50
40.42        4042.50        -110.00
42.20        4220.00          67.50
40.42        4042.50        -110.00
39.77        3977.50        -175.00
40.55        4055.00         -97.50
42.13        4212.50          60.00
42.05        4205.00          52.50
41.08        4107.50         -45.00
41.70        4170.00          17.50
43.77        4377.50         225.00
41.00        4100.00         -52.50
42.30        4230.00          77.50
39.27        3927.50        -225.00
42.73        4272.50         120.00
41.77        4177.50          25.00
40.67        4067.50         -85.00
40.25        4025.00        -127.50
42.22        4222.50          70.00
42.00        4200.00          47.50
40.97        4097.50         -55.00
41.05        4105.00         -47.50
41.47        4147.50          -5.00
41.85        4185.00          32.50
41.13        4112.50         -40.00
41.72        4172.50          20.00
42.72        4272.50         120.00
39.45        3945.00        -207.50
42.02        4202.50          50.00
40.47        4047.50        -105.00
40.67        4067.50         -85.00
41.65        4165.00          12.50
40.55        4055.00         -97.50
41.83        4182.50          30.00
42.70        4270.00         117.50
44.00        4400.00         247.50
39.00        3900.00        -252.50
41.13        4112.50         -40.00
43.35        4335.00         182.50
42.27        4227.50          75.00
40.75        4075.00         -77.50
39.80        3980.00        -172.50
42.13        4212.50          60.00
41.85        4185.00          32.50
41.58        4157.50           5.00
39.88        3987.50        -165.00
41.40        4140.00         -12.50
40.52        4052.50        -100.00
41.57        4157.50           5.00
41.33        4132.50         -20.00
40.80        4080.00         -72.50
40.80        4080.00         -72.50
43.45        4345.00         192.50
40.13        4012.50        -140.00
41.65        4165.00          12.50
42.23        4222.50          70.00
41.40        4140.00         -12.50
41.77        4177.50          25.00
41.40        4140.00         -12.50
42.05        4205.00          52.50
41.77        4177.50          25.00
42.27        4227.50          75.00
41.67        4167.50          15.00
40.38        4037.50        -115.00
41.52        4152.50           0.00
42.38        4237.50          85.00
41.57        4157.50           5.00
40.92        4092.50         -60.00
41.63        4162.50          10.00
41.15        4115.00         -37.50
42.23        4222.50          70.00
40.77        4077.50         -75.00
41.67        4167.50          15.00
40.95        4095.00         -57.50
41.88        4187.50          35.00
42.02        4202.50          50.00
43.33        4332.50         180.00
40.90        4090.00         -62.50
40.75        4075.00         -77.50
41.35        4135.00         -17.50
41.80        4180.00          27.50
41.67        4167.50          15.00
43.70        4370.00         217.50
43.35        4335.00         182.50
39.15        3915.00        -237.50
39.90        3990.00        -162.50
41.30        4130.00         -22.50
40.88        4087.50         -65.00
40.38        4037.50        -115.00
41.13        4112.50         -40.00
40.13        4012.50        -140.00
42.17        4217.50          65.00
44.92        4492.50         340.00
41.50        4150.00          -2.50
41.92        4192.50          40.00
42.73        4272.50         120.00
40.95        4095.00         -57.50
41.83        4182.50          30.00
41.92        4192.50          40.00
42.38        4237.50          85.00
43.88        4387.50         235.00
44.30        4430.00         277.50
40.90        4090.00         -62.50
41.55        4155.00           2.50
41.13        4112.50         -40.00
38.22        3822.50        -330.00
46.55        4655.00         502.50
40.23        4022.50        -130.00
41.10        4110.00         -42.50
40.90        4090.00         -62.50
40.60        4060.00         -92.50
41.95        4195.00          42.50
42.70        4270.00         117.50
44.02        4402.50         250.00
47.90        4790.00         637.50
44.80        4480.00         327.50
40.85        4085.00         -67.50
35.92        3592.50        -560.00
38.88        3887.50        -265.00
40.65        4065.00         -87.50
41.70        4170.00          17.50
47.05        4705.00         552.50
37.73        3772.50        -380.00
42.77        4277.50         125.00
42.57        4257.50         105.00
39.23        3922.50        -230.00
42.42        4242.50          90.00
39.65        3965.00        -187.50
40.17        4017.50        -135.00
40.60        4060.00         -92.50
40.50        4050.00        -102.50
41.20        4120.00         -32.50
43.08        4307.50         155.00
42.12        4212.50          60.00
40.13        4012.50        -140.00
43.20        4320.00         167.50
40.70        4070.00         -82.50
40.95        4095.00         -57.50
41.75        4175.00          22.50
43.63        4362.50         210.00
44.90        4490.00         337.50
39.57        3957.50        -195.00
42.45        4245.00          92.50
40.92        4092.50         -60.00
41.10        4110.00         -42.50
41.45        4145.00          -7.50
41.25        4125.00         -27.50
42.35        4235.00          82.50
39.23        3922.50        -230.00
41.67        4167.50          15.00
41.35        4135.00         -17.50
42.97        4297.50         145.00
40.00        4000.00        -152.50
42.08        4207.50          55.00
40.97        4097.50         -55.00
39.80        3980.00        -172.50
41.48        4147.50          -5.00
40.07        4007.50        -145.00
38.98        3897.50        -255.00
44.88        4487.50         335.00
43.17        4317.50         165.00
36.40        3640.00        -512.50
40.58        4057.50         -95.00
42.27        4227.50          75.00
40.17        4017.50        -135.00
40.58        4057.50         -95.00
41.88        4187.50          35.00
42.00        4200.00          47.50
41.45        4145.00          -7.50
41.75        4175.00          22.50
44.63        4462.50         310.00
41.80        4180.00          27.50
41.75        4175.00          22.50
44.32        4432.50         280.00
40.02        4002.50        -150.00
41.92        4192.50          40.00
38.77        3877.50        -275.00
40.40        4040.00        -112.50
41.10        4110.00         -42.50
42.38        4237.50          85.00
40.72        4072.50         -80.00
42.10        4210.00          57.50
41.55        4155.00           2.50
41.35        4135.00         -17.50
42.00        4200.00          47.50
42.15        4215.00          62.50
42.50        4250.00          97.50
38.40        3840.00        -312.50
42.05        4205.00          52.50
41.58        4157.50           5.00
43.80        4380.00         227.50
41.13        4112.50         -40.00
44.02        4402.50         250.00
41.88        4187.50          35.00
42.62        4262.50         110.00
40.88        4087.50         -65.00
43.33        4332.50         180.00
44.05        4405.00         252.50
40.35        4035.00        -117.50
41.40        4140.00         -12.50
40.08        4007.50        -145.00
41.97        4197.50          45.00
42.68        4267.50         115.00
39.72        3972.50        -180.00
42.80        4280.00         127.50
Expected shortfall in 95.00% is -597.95
The one day 95% VaR based on Historical method is: -237.50

Calculate VaR by Monte Carlo without simulating volatility (GBM only)
Expected shortfall in 95.00% is -371.34
The one day 95% VaR based on Monte Carlo with only GBM model is: -266.71

Calculate VaR by analytical method (mu-alpha*sigma)
The one day 95% VaR based on Analytical method is: -291.43

Calculate VaR by using greeks letter:
Expected shortfall in 95.00% is -294.15
The one day 95% VaR based on Analytical method with Greeks letter is: -206.59

Press any key to continue . . .
